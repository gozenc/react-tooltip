<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>React Tooltip Demo | @gozenc/react-tooltip</title>
  <style>
    :root {
      color-scheme: light dark;
    }

    body {
      margin: 0;
      padding: 2.5rem 1.5rem;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      text-align: center;
      display: grid;
      gap: 2rem;
    }

    h1 {
      margin: 0;
      font-size: clamp(2rem, 3vw, 3rem);
      letter-spacing: -0.03em;
    }

    h2 {
      margin-bottom: 0.75rem;
      letter-spacing: -0.01em;
    }

    p.lead {
      margin: 0 auto;
      max-width: 540px;
      color: rgba(255, 255, 255, 0.9);
    }

    .demo-section {
      margin: 0;
      padding: 2.5rem 2rem;
      border-radius: 18px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.2);
    }

    .demo-section h3 {
      margin-top: 0;
      font-size: 1.5rem;
    }

    .demo-section p {
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 1.5rem;
    }

    .button-row {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin: 1.5rem 0;
    }

    .demo-button {
      padding: 0.75rem 1.5rem;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.15);
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .demo-button:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .status {
      padding: 1.25rem;
      margin: 0;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      text-align: left;
    }

    .status strong {
      display: inline-block;
      min-width: 10rem;
    }

    .status p {
      margin: 0.35rem 0;
    }

    .item-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      margin: 1.5rem 0;
    }

    .grid-item {
      padding: 1rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.15);
      font-weight: 600;
      cursor: default;
    }
  </style>
</head>

<body>
  <main class="container" role="main">
    <header>
      <h1>@gozenc/react-tooltip</h1>
      <h2>Live Demo & QA Playground</h2>
      <p class="lead">A super-lightweight, dependency-free React tooltip component optimized for high-performance
        applications with hundreds of tooltips.</p>
    </header>

    <div class="status">
      <p><strong>Bundle Size:</strong> <span id="bundle-size">Loading...</span></p>
      <p><strong>Status:</strong> <span id="status">Loading...</span></p>
      <p><strong>React JSX Runtime:</strong> <span id="jsx-runtime">Checking...</span></p>
    </div>

    <section class="demo-section">
      <h3>Default Tooltip</h3>
      <p>Hover over the button to see the tooltip appear.</p>
      <div class="button-row" id="demo-1"></div>
    </section>

    <section class="demo-section">
      <h3>Different Positions</h3>
      <p>Tooltips can be positioned on all four sides of the element.</p>
      <div class="button-row" id="demo-2"></div>
    </section>

    <section class="demo-section">
      <h3>Custom Offset & Delay</h3>
      <p>Adjust the distance and hover delay for different use cases.</p>
      <div class="button-row" id="demo-3"></div>
    </section>

    <section class="demo-section">
      <h3>Multiple Tooltips</h3>
      <p>Performance test with 20 tooltip instances on a single page.</p>
      <div class="item-grid" id="demo-4"></div>
    </section>
  </main>

  <!-- React CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Import map to resolve React modules -->
  <script type="importmap">
    {
      "imports": {
        "react": "data:text/javascript,export default window.React; export const createElement = window.React.createElement; export const useEffect = window.React.useEffect; export const useRef = window.React.useRef; export const useState = window.React.useState; export const useCallback = window.React.useCallback; export const Fragment = window.React.Fragment;",
        "react/jsx-runtime": "data:text/javascript,export const jsx = window.React.createElement; export const jsxs = window.React.createElement; export const Fragment = window.React.Fragment;"
      }
    }
  </script>

  <script type="module">
    try {
      // Get bundle size first
      const response = await fetch('./dist/index.js');
      const text = await response.text();
      const sizeKB = (text.length / 1024).toFixed(2);
      const sizeGzipped = await getGzippedSize(text);

      // Check for react-jsx-runtime
      const hasJsxRuntime = text.includes('react-jsx-runtime') || text.includes('jsx-runtime');
      const runtimeStatus = hasJsxRuntime ? '❌ YES (should be excluded)' : '✅ NO (correctly excluded)';

      document.getElementById('bundle-size').innerHTML = `${sizeKB} KB (${sizeGzipped} KB gzipped)`;
      document.getElementById('jsx-runtime').innerHTML = runtimeStatus;
      document.getElementById('status').innerHTML = `Loading component...`;

      // Import the built component
      const { Tooltip } = await import('./dist/index.js');

      document.getElementById('status').innerHTML = `✅ Component loaded successfully!`;

      // Create React elements
      const { createElement } = React;
      const { createRoot } = ReactDOM;

      // Demo 1: Default tooltip
      const root1 = createRoot(document.getElementById('demo-1'));
      root1.render(
        createElement(Tooltip, { content: 'This is a tooltip!' },
          createElement('button', { className: 'demo-button' }, 'Hover me')
        )
      );

      // Demo 2: Different positions
      const root2 = createRoot(document.getElementById('demo-2'));
      root2.render(
        createElement(React.Fragment, null,
          createElement(Tooltip, { content: 'Top tooltip', position: 'top' },
            createElement('button', { className: 'demo-button' }, 'Top')
          ),
          createElement(Tooltip, { content: 'Right tooltip', position: 'right' },
            createElement('button', { className: 'demo-button' }, 'Right')
          ),
          createElement(Tooltip, { content: 'Bottom tooltip', position: 'bottom' },
            createElement('button', { className: 'demo-button' }, 'Bottom')
          ),
          createElement(Tooltip, { content: 'Left tooltip', position: 'left' },
            createElement('button', { className: 'demo-button' }, 'Left')
          )
        )
      );

      // Demo 3: Custom offset & delay
      const root3 = createRoot(document.getElementById('demo-3'));
      root3.render(
        createElement(React.Fragment, null,
          createElement(Tooltip, { content: 'Small offset (4px)', offset: 4 },
            createElement('button', { className: 'demo-button' }, 'Small offset')
          ),
          createElement(Tooltip, { content: 'Large offset (20px)', offset: 20 },
            createElement('button', { className: 'demo-button' }, 'Large offset')
          ),
          createElement(Tooltip, { content: 'Instant (0ms)', delay: 0 },
            createElement('button', { className: 'demo-button' }, 'Instant')
          ),
          createElement(Tooltip, { content: 'Slow (800ms)', delay: 800 },
            createElement('button', { className: 'demo-button' }, 'Slow')
          )
        )
      );

      // Demo 4: Multiple tooltips
      const root4 = createRoot(document.getElementById('demo-4'));
      const items = Array.from({ length: 20 }, (_, i) => i + 1);
      root4.render(
        createElement(React.Fragment, null,
          ...items.map(i =>
            createElement(Tooltip, { content: `Tooltip #${i}`, key: i },
              createElement('div', { className: 'grid-item' }, `Item ${i}`)
            )
          )
        )
      );

    } catch (error) {
      console.error('Error loading component:', error);
      document.getElementById('status').textContent = 'Error: ' + error.message;
    }

    async function getGzippedSize(text) {
      if ('CompressionStream' in window) {
        const stream = new CompressionStream('gzip');
        const writer = stream.writable.getWriter();
        const reader = stream.readable.getReader();

        writer.write(new TextEncoder().encode(text));
        writer.close();

        let compressedSize = 0;
        let done = false;

        while (!done) {
          const { value, done: readerDone } = await reader.read();
          done = readerDone;
          if (value) {
            compressedSize += value.length;
          }
        }

        return (compressedSize / 1024).toFixed(2);
      }
      return 'N/A';
    }
  </script>
</body>

</html>